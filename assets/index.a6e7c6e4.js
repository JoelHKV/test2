(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function o(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=o(r);fetch(r.href,i)}})();var x,D,O,d,u,g=1,h,b=0,p="Nimi",I="Osoite",j="Kaupunki",C="Helsinki",$=[["stationvstrip",5,1,35,10],["stationvstrip2",45,1,35,10],["menu",10,30,70,70],["menutitleb",10,25,70,4],["menutitle",10,25,70,4],["map-container",10,25,70,70],["innercalendar",10,30,70,70],["departure_dropdown",10,18,30,6],["return_dropdown",50,18,30,6],["infoboard",10,15,30,10],["infoboard2",40,15,20,10],["infoboard3",61,15,30,10],["goUp",88,36,10,10],["scrollUp",88,48,10,10],["currentdate",88,60,10,10],["scrollDown",88,72,10,10],["goDown",88,84,10,10],["stationdetails",70,15,10,5],["closemap",70,25,10,5],["backgroundgray",5,10,80,95],["language",88,10,6,6]];P($);function P(e){const t=document.querySelector("#container");var o=parseInt(window.getComputedStyle(t).width),n=parseInt(window.getComputedStyle(t).height);for(let r=0;r<e.length;r++){const i=document.getElementById(e[r][0]);i.style.left=o*e[r][1]/100+"px",i.style.top=n*e[r][2]/100+"px",i.style.width=o*e[r][3]/100+"px",i.style.height=n*e[r][4]/100+"px"}document.getElementById("filterStations").style.width=o*20/100+"px"}function E(e,t,o){for(let n=0;n<e.length;n++)document.getElementById(e[n]).style.zIndex=t+30-n,document.getElementById(e[n]).style.visibility="visible";for(let n=0;n<o.length;n++)document.getElementById(o[n]).style.visibility="hidden"}E([],1,["departure_dropdown","return_dropdown","infoboard3","infoboard2","closemap","stationdetails","map-container"]);document.getElementById("stationvstrip").addEventListener("click",X);document.getElementById("stationvstrip2").addEventListener("click",Q);document.getElementById("currentdate").addEventListener("click",U);const A=document.getElementById("filterStations");A.addEventListener("input",()=>{T(d)});document.querySelector("#goUp").addEventListener("click",function(){if(g==1){c.scrollTop=0;return}h=0,w(-1)});document.querySelector("#scrollUp").addEventListener("click",function(){if(g==1){c.scrollTop-=c.scrollHeight/20;return}h-=1e3,w(0)});document.querySelector("#scrollDown").addEventListener("click",function(){if(g==1){c.scrollTop+=c.scrollHeight/20;return}h>Object.entries(u).length&&h==Object.entries(u).length,h+=1e3,w(0)});document.querySelector("#goDown").addEventListener("click",function(){if(g==1){c.scrollTop=c.scrollHeight;return}h=Object.entries(u).length,w(1)});document.querySelector("#stationdetails").addEventListener("click",function(){k("https://readlocalcsvdeliverjson-c2cjxe2frq-lz.a.run.app/?action=D"+b.toString(),4)});document.querySelector("#closemap").addEventListener("click",function(){g==1?(E(["menutitleb"],1,["infoboard3","infoboard2","closemap","stationdetails","map-container","infoboard"]),D&&D.setMap(null)):E(["menutitle"],1,["infoboard3","infoboard2","closemap","stationdetails","map-container","infoboard"]),O&&O.setMap(null)});function U(){if(g==1)return;var e=document.getElementById("currentdate").innerHTML,t=K(2021,4,7,e);document.getElementById("innercalendar").innerHTML=t;let o=document.getElementsByClassName("generatedCell");document.getElementById("innercalendar").style.zIndex=10;for(let n=0;n<o.length;n++)o[n].addEventListener("click",function(){let r=this.getAttribute("data-param");document.getElementById("currentdate").innerHTML=r,document.getElementById(e).style.backgroundColor="#ffffff",document.getElementById(r).style.backgroundColor="#999999";var i=document.getElementById("currentdate").innerHTML.split("."),a=i[2].toString()+"-"+i[1].toString().padStart(2,"0")+"-"+i[0].toString().padStart(2,"0");k("https://readlocalcsvdeliverjson-c2cjxe2frq-lz.a.run.app/?action="+a,3),setTimeout(()=>{document.getElementById("innercalendar").style.zIndex=-1},400)})}document.querySelector("#language").addEventListener("click",function(){J();var e=document.getElementById("language").innerHTML,t;e=="FI"&&(t="SV",p="Namn",I="Adress",C="Helsingfors"),e=="SV"&&(t="EN",p="Name",I="Osoite",C="Helsinki"),e=="EN"&&(t="FI",p="Nimi",I="Osoite",C="Helsinki"),document.getElementById("language").innerHTML=t,F(d,tempkeys),g==1&&T(d),g==1&&M(b,"station"),g==-1&&M(b,"trip")});function V(e){u=e,h=Math.round(Object.entries(u).length/2),w(0)}const c=document.querySelector("#menu");function H(e,t){const o=document.createElement("div");o.classList.add("menu-item");const n=document.createElement("div");n.classList.add("col","col-1"),n.style.width="100%",n.style.border="1px solid black",n.style.backgroundColor="#A5A5A5",n.style.textAlign="center",n.textContent=e,o.appendChild(n),o.addEventListener("click",function(){t==1&&(h-=1e3,w(1)),t==-1&&(h+=1e3,w(-1))}),c.appendChild(o)}function _(e){E(["infoboard3","infoboard2"],1,[]);var t=Object.entries(e).length,o=[],n=[],r=new Array(1e3).fill(0);for(let f=0;f<t;f++){let m=parseFloat(e[f].dis);isFinite(m)&&o.push(m);let B=parseInt(e[f].time);isFinite(B)&&n.push(B);let W=parseInt(e[f].rid);r[W]++}const i=Math.round(10*(o.reduce((f,m)=>f+m,0)/o.length))/10,a=Math.round(1*(n.reduce((f,m)=>f+m,0)/n.length))/1;document.getElementById("infoboard3").innerHTML=t+"<BR>"+i+" km<BR>"+a+" min";for(var l=new Array(1e3),s=0;s<1e3;++s)l[s]=s;l.sort(function(f,m){return r[f]<r[m]?-1:r[f]>r[m]?1:0});for(var v=[d[b].y,d[b].x],s=999;s>995;s--){var y=[d[l[s]].y,d[l[s]].x];z(v,y,1e3-s,"markersnocenter")}}function w(e){for(;c.firstChild;)c.removeChild(c.firstChild);const t=[20,25,25,10,10];var o=500;H("Next Up",1);var n=Math.max(h-o,0);for(let r=n;r<Math.min(h+o,Object.entries(u).length);r++){const i=document.createElement("div");i.classList.add("menu-item");for(let a=1;a<=5;a++){const l=document.createElement("div");l.classList.add("col",`col-${r}`),l.style.width=`${t[a-1]}%`,l.style.textAlign="left",a==1&&(l.textContent=u[r].Departure.substring(8,10)+"."+u[r].Departure.substring(5,7)+" "+u[r].Departure.substring(11,16)),a==2&&(l.textContent=d[u[r].did][p].substring(0,12)),a==3&&(l.textContent=d[u[r].rid][p].substring(0,12)),a==4&&(l.textContent=u[r].dis),a==5&&(l.textContent=u[r].time),i.appendChild(l)}i.addEventListener("click",function(){const a=c.querySelectorAll(".menu-item");for(const f of a)f.style.backgroundColor="";this.style.backgroundColor="gray";var l=n+Array.from(a).indexOf(this)-1,s=[d[u[l].did].y,d[u[l].did].x],v=[d[u[l].rid].y,d[u[l].rid].x];let y="From: "+d[u[l].did][p]+"<BR>To: ";y+=d[u[l].rid][p]+"<BR>",y+="Dist: "+u[l].dis+" km Time: "+u[l].time+" min",b=u[l],M(b,"trip"),N([s,v],2)}),c.appendChild(i)}H("Next Down",-1),e==1&&(c.scrollTop=c.scrollHeight),e==0&&(c.scrollTop=c.scrollHeight/2),e==-1&&(c.scrollTop=0)}let L=document.getElementById("departure_dropdown"),S=document.getElementById("return_dropdown");L.onchange=function(){let t=/\(([^)]+)\)/.exec(L.value)[1];k("https://readlocalcsvdeliverjson-c2cjxe2frq-lz.a.run.app/?action=D"+t.toString(),3)};S.onchange=function(){let t=/\(([^)]+)\)/.exec(S.value)[1];k("https://readlocalcsvdeliverjson-c2cjxe2frq-lz.a.run.app/?action=R"+t.toString(),3)};function J(){const e={lat:64,lng:26};x=new google.maps.Map(document.getElementById("map"),{zoom:5,center:e})}function q(e,t){D=new google.maps.Marker({position:{lat:e[0],lng:e[1]},map:x,label:{text:t,color:"black",fontSize:"24px",fontWeight:"bold"},labelOrigin:new google.maps.Point(125,30),optimized:!1})}function N(e,t){E(["closemap","stationdetails","map-container","infoboard"],1,["departure_dropdown","return_dropdown","menutitle","menutitleb"]),t==1&&(x.setCenter({lat:e[0],lng:e[1]}),q(e," "),R([{lat:e[0]+.005,lng:e[1]+.005},{lat:e[0]-.005,lng:e[1]-.005}])),t==2&&z(e[0],e[1]," ","fittobounds")}function z(e,t,o,n){var r={lat:e[0],lng:e[1]},i={lat:t[0],lng:t[1]};n=="fittobounds"&&(x.setCenter({lat:(e[0]+t[0])/2,lng:(e[1]+t[1])/2}),R([{lat:Math.max(e[0],t[0]),lng:Math.max(e[1],t[1])},{lat:Math.min(e[0],t[0]),lng:Math.min(e[1],t[1])}]),E([],1,["stationdetails"])),n=="markersnocenter"&&q(t,o.toString()),O=new google.maps.Polyline({path:[r,i],geodesic:!0,strokeColor:"#ff0000",strokeOpacity:1,strokeWeight:4,icons:[{icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW},offset:"100%"}],map:x})}function R(e){for(var t=new google.maps.LatLngBounds,o=0;o<e.length;o++)t.extend(e[o]);x.fitBounds(t)}function K(e,t,o,n){const r=["January","February","March","April","May","June","July","August","September","October","November","December"];let i="#ffffff",a=`
    <style>
      table {
        width: 100%;
        border-collapse: collapse;
      }

      td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
        cursor: pointer;
      }</style>`;for(let s=t;s<o;s++){const v=new Date(e,s+1,0).getDate();a+=`
 
    <table>
      <thead>
        <tr>            
          <th colspan="7">${r[s]} ${e}</th>          
        </tr>
        <tr>
            <th colspan="7">&nbsp;</th>
        </tr>
        <tr>
          <th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th><th>Sun</th>
        </tr>
      </thead>
      <tbody>
        <tr>
  `;let f=new Date(e,s,1).getDay()||7,m=1;for(let B=1;B<f;B++)a+="<td></td>";for(;m<=v;){f===8&&(a+="</tr><tr>",f=1);var l=m+"."+(s+1)+"."+e;l==n&&(i="#999999"),a+=`<td style="cursor: pointer; background-color: ${i};" id='${l}' class="generatedCell" data-param='${l}'>${m}</td>`,i="#ffffff",f++,m++}a+=`
        </tr>
      </tbody>
    </table>`}return a}k("https://jsonhandler-c2cjxe2frq-lz.a.run.app/?action=stations",1);function k(e,t){o(e).then(n=>{t==1&&T(n),t==3&&V(n),t==4&&_(n)}).catch(n=>{G()});async function o(n,r){let i=await fetch(n,{method:"GET"});return i.headers.get("Content-Type").includes("application/json")?await i.json():await i.text()}}function F(e,t){L.options.length=0,S.options.length=0;for(let o=-1;o<t.length;o++){let n=document.createElement("option");o>-1?n.text=e[t[o]][p]+" ("+t[o]+")":n.text="All Stations",L.add(n),S.add(n.cloneNode(!0))}}function T(e){for(;c.firstChild;)c.removeChild(c.firstChild);const t=A.value.toLowerCase();d=e;var n=Object.entries(d).sort((a,l)=>a[1][p]>l[1][p]?1:-1).map(a=>a[0]);F(d,n);let r=[];for(let a=0;a<n.length;a++){var i=d[n[a]][p];if(i.toLowerCase().startsWith(t)==!0){r.push(n[a]);const l=document.createElement("div");l.classList.add("menu-item");const s=document.createElement("div");s.classList.add("col","col-1"),s.style.width="100%",s.style.textAlign="left",s.textContent=i,l.appendChild(s),l.addEventListener("click",function(){const v=c.querySelectorAll(".menu-item");for(const m of v)m.style.backgroundColor="";this.style.backgroundColor="gray";var y=Array.from(v).indexOf(this);M(r[y],"station");var f=[d[r[y]].y,d[r[y]].x];b=r[y],N(f,1)}),c.appendChild(l)}}}function M(e,t){if(t=="trip"){let o="From: "+d[e.did][p]+"<BR>To: ";o+=d[e.rid][p]+"<BR>Dist: ",o+=e.dis+" km Time: "+e.time+" min",document.getElementById("infoboard").innerHTML=o}if(t=="station"){let o=d[e][p]+"<BR>";o+=d[e][I]+"<BR>",d[e][j].length>1?o+=d[e][j]:o+=C,document.getElementById("infoboard").innerHTML=o}}function G(){alert("fdfd")}function Q(){E(["menutitle","departure_dropdown","return_dropdown"],1,["menutitleb","infoboard3","infoboard2","closemap","stationdetails","map-container"]),document.getElementById("currentdate").style.cursor="pointer";var e=document.getElementById("currentdate").innerHTML.split("."),t=e[2].toString()+"-"+e[1].toString().padStart(2,"0")+"-"+e[0].toString().padStart(2,"0");k("https://readlocalcsvdeliverjson-c2cjxe2frq-lz.a.run.app/?action="+t,3),document.getElementById("stationvstrip").style.backgroundColor="#ffffff",document.getElementById("stationvstrip2").style.backgroundColor="#eeeeee"}function X(){g=1,g==1&&(E(["menutitleb"],1,["menutitle","departure_dropdown","return_dropdown","infoboard3","infoboard2","closemap","stationdetails","map-container"]),document.getElementById("currentdate").style.cursor="default",document.getElementById("filterStations").style.zIndex=1,document.getElementById("currentdate").style.opacity=.4,T(d)),document.getElementById("stationvstrip2").style.backgroundColor="#ffffff",document.getElementById("stationvstrip").style.backgroundColor="#eeeeee"}
